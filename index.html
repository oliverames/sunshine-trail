<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Sunshine Trail | Lawson's Finest Liquids</title>
    <meta name="description" content="Explore Sunshine Spots from Waitsfield, VT to Asheville, NC. Interactive map of retailers, hiking trails, river put-ins, and community partners along the Appalachian corridor.">
    <meta name="theme-color" content="#2d2a26">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="anonymous">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Lawson's Finest brand colors - extracted from website */
            --sunshine-gold: #EAC054;      /* Primary gold from "Explore" text & Beer Finder button */
            --sunshine-orange: #E87722;    /* Orange from sun logo */
            --sunshine-red: #C13A28;       /* Red accent from sun logo */
            --deep-brown: #2d2a26;         /* Logo text color */
            --forest-green: #3A5F3A;       /* Trail marker - earthy green */
            --river-blue: #4A90A4;         /* River marker - mountain stream blue */
            --community-purple: #7B5B9A;   /* Community marker - softer purple */
            --cream: #FFFBF2;              /* Warm cream background */
            --light-gold: #FDF5E6;         /* Light gold for highlights */
            --amber: #FCB900;              /* Luminous amber from site */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Open Sans', sans-serif;
            background-color: var(--cream);
            color: var(--deep-brown);
        }

        header {
            background: #ffffff;
            color: var(--deep-brown);
            padding: 0.75rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #e5e5e5;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-trail-logo {
            height: 55px;
            width: auto;
        }

        .brand-logo-link {
            display: flex;
            align-items: center;
        }

        .header-brand-logo {
            height: 38px;
            width: auto;
            opacity: 1;
            transition: opacity 0.2s;
        }

        .header-brand-logo:hover {
            opacity: 0.8;
        }

        h1 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 800;
            font-size: 1.6rem;
            letter-spacing: 0.5px;
            color: var(--deep-brown);
        }

        h1 span {
            color: var(--sunshine-gold);
        }

        .tagline {
            font-size: 0.8rem;
            color: #666;
            font-weight: 400;
            margin-top: 0.15rem;
        }

        .filter-icon {
            width: 28px;
            height: 28px;
            object-fit: contain;
        }

        main {
            display: flex;
            height: calc(100vh - 110px); /* Account for header and footer */
        }

        .sidebar {
            width: 320px;
            background: white;
            padding: 1.5rem;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }

        .sidebar h2 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 1rem;
            color: var(--deep-brown);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .intro-text {
            font-size: 0.9rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
            color: #555;
        }

        .filter-section {
            margin-bottom: 1.5rem;
        }

        .filter-section h3 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 0.75rem;
            color: var(--deep-brown);
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .filter-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 6px;
            transition: background-color 0.2s;
        }

        .filter-item:hover {
            background-color: var(--light-gold);
        }

        .filter-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--sunshine-gold);
        }

        .filter-item label {
            cursor: pointer;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }


        .count-badge {
            background: var(--light-gold);
            padding: 0.15rem 0.5rem;
            border-radius: 10px;
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--deep-brown);
        }

        .legend {
            background: var(--light-gold);
            padding: 1rem;
            border-radius: 8px;
            margin-top: 1rem;
        }

        .legend h4 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 0.85rem;
            margin-bottom: 0.75rem;
        }

        .legend p {
            font-size: 0.8rem;
            line-height: 1.5;
            color: #555;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.8rem;
            margin-bottom: 0.4rem;
        }

        #map {
            flex: 1;
            height: 100%;
        }

        /* Smooth Leaflet transitions */
        .leaflet-tile-container {
            transform: translateZ(0);
            will-change: transform;
        }

        .leaflet-zoom-anim .leaflet-zoom-animated {
            transition: transform 0.25s cubic-bezier(0.25, 0.1, 0.25, 1);
        }

        .leaflet-pan-anim .leaflet-tile,
        .leaflet-pan-anim .leaflet-marker-pane {
            transition: transform 0.25s ease-out;
        }

        .leaflet-fade-anim .leaflet-popup {
            transition: opacity 0.2s ease-in-out;
        }

        .leaflet-marker-icon {
            transition: transform 0.15s ease-out, filter 0.15s ease-out;
            transform-origin: center bottom;
        }

        .leaflet-marker-icon:hover {
            transform: scale(1.1) translateY(-2px);
            filter: drop-shadow(0 4px 6px rgba(0,0,0,0.3));
        }

        /* Prevent marker icon distortion */
        .marker-icon {
            background: transparent !important;
        }

        /* Custom Leaflet popup styles */
        .leaflet-popup-content-wrapper {
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .leaflet-popup-content {
            margin: 12px 16px;
            font-family: 'Open Sans', sans-serif;
        }

        .popup-title {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            font-size: 1rem;
            color: var(--deep-brown);
            margin-bottom: 0.5rem;
        }

        .popup-category {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.5rem;
        }

        .popup-category.retailer { background: var(--sunshine-gold); color: var(--deep-brown); }
        .popup-category.trail { background: var(--forest-green); color: white; }
        .popup-category.river { background: var(--river-blue); color: white; }
        .popup-category.community { background: var(--community-purple); color: white; }
        .popup-category.charger { background: #22c55e; color: white; }

        .popup-content-wrapper {
            max-height: 400px;
            overflow-y: auto;
        }

        .popup-description {
            font-size: 0.85rem;
            line-height: 1.5;
            color: #555;
            margin-bottom: 0.5rem;
        }

        .popup-location {
            font-size: 0.8rem;
            color: #777;
        }

        .popup-link {
            display: inline-block;
            margin-top: 0.5rem;
            color: var(--river-blue);
            text-decoration: none;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .popup-link:hover {
            text-decoration: underline;
        }

        .popup-image {
            width: 100%;
            height: 120px;
            object-fit: cover;
            border-radius: 6px;
            margin-bottom: 0.75rem;
        }

        .popup-impact {
            background: var(--light-gold);
            padding: 0.6rem;
            border-radius: 6px;
            margin: 0.5rem 0;
            font-size: 0.8rem;
            line-height: 1.5;
            border-left: 3px solid var(--sunshine-gold);
        }

        .popup-impact-label {
            font-weight: 600;
            color: var(--deep-brown);
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 0.25rem;
        }

        .popup-buttons {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.75rem;
        }

        .popup-btn {
            display: inline-block;
            padding: 0.4rem 0.75rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            text-decoration: none;
            text-align: center;
            flex: 1;
        }

        .popup-btn-primary {
            background: var(--sunshine-gold);
            color: var(--deep-brown);
        }

        .popup-btn-secondary {
            background: var(--deep-brown);
            color: var(--cream);
        }

        .popup-btn:hover {
            opacity: 0.9;
        }

        /* Custom marker styles */
        .leaflet-marker-icon {
            background: transparent !important;
            border: none !important;
            box-shadow: none !important;
        }

        /* Mobile responsive */
        @media (max-width: 768px) {
            main {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: auto;
                max-height: 40vh;
                order: 2;
            }

            #map {
                height: 60vh;
                order: 1;
            }

            header {
                flex-direction: column;
                text-align: center;
                gap: 0.75rem;
                padding: 0.75rem 1rem;
            }

            h1 {
                font-size: 1.3rem;
            }

            .header-trail-logo {
                height: 45px;
            }

            .header-brand-logo {
                height: 30px;
            }
        }

        .footer-bar {
            background: var(--deep-brown);
            color: var(--cream);
            padding: 0.5rem 1.5rem;
            font-size: 0.8rem;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .footer-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
        }

        .footer-tagline {
            opacity: 0.9;
        }

        .footer-link {
            color: var(--sunshine-gold);
            text-decoration: none;
            font-weight: 600;
        }

        .footer-link:hover {
            text-decoration: underline;
        }

        .footer-bcorp {
            height: 45px;
            width: auto;
            filter: brightness(0) invert(1);
            opacity: 0.9;
        }
        /* Page Load Animations */
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }
            50% {
                transform: scale(1.05);
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        @keyframes shimmer {
            0% {
                background-position: -200% 0;
            }
            100% {
                background-position: 200% 0;
            }
        }

        /* Apply animations */
        header {
            animation: fadeInDown 0.6s ease-out;
        }

        .sidebar {
            animation: fadeInLeft 0.6s ease-out 0.2s both;
        }

        .intro-text {
            animation: fadeIn 0.8s ease-out 0.4s both;
        }

        .filter-section {
            animation: fadeInUp 0.6s ease-out 0.5s both;
        }

        .filter-item {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .filter-item:hover {
            transform: translateX(5px);
            background-color: var(--light-gold);
        }

        .filter-item:active {
            transform: translateX(2px) scale(0.98);
        }

        .legend {
            animation: fadeInUp 0.6s ease-out 0.7s both;
        }

        #map {
            animation: fadeIn 1s ease-out 0.3s both;
        }

        footer {
            animation: fadeInUp 0.5s ease-out 0.8s both;
        }

        /* Marker bounce animation */
        .leaflet-marker-icon {
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .leaflet-marker-icon:hover {
            transform: scale(1.2) translateY(-5px) !important;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
        }

        /* Filter checkbox animation */
        .filter-item input[type="checkbox"] {
            transition: transform 0.2s ease;
        }

        .filter-item input[type="checkbox"]:checked {
            animation: pulse 0.3s ease;
        }

        /* Count badge animation */
        .count-badge {
            transition: all 0.3s ease;
        }

        .filter-item:hover .count-badge {
            background: var(--sunshine-gold);
            transform: scale(1.1);
        }

        /* Button hover effects */
        .popup-btn {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .popup-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .popup-btn:active {
            transform: translateY(0);
        }

        /* Logo hover effect */
        .header-trail-logo {
            transition: transform 0.3s ease;
        }

        .header-trail-logo:hover {
            transform: scale(1.05);
        }

        /* Shimmer effect for loading state */
        .loading {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }

        /* State Filter Buttons */
        .state-filter-section {
            margin-bottom: 1.5rem;
            animation: fadeInUp 0.6s ease-out 0.6s both;
        }

        .state-filter-section h3 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 0.75rem;
            color: var(--deep-brown);
        }

        .state-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .state-btn {
            padding: 0.4rem 0.75rem;
            border: 2px solid var(--community-purple);
            background: white;
            color: var(--community-purple);
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .state-btn:hover {
            background: var(--community-purple);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(123, 91, 154, 0.3);
        }

        .state-btn.active {
            background: var(--community-purple);
            color: white;
        }

        .state-btn.all-states {
            border-color: var(--sunshine-gold);
            color: var(--deep-brown);
        }

        .state-btn.all-states:hover,
        .state-btn.all-states.active {
            background: var(--sunshine-gold);
            color: var(--deep-brown);
        }

        /* Live Metrics Section */
        .metrics-section {
            background: linear-gradient(135deg, var(--deep-brown) 0%, #1a1816 100%);
            padding: 1.25rem;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            animation: fadeInUp 0.6s ease-out 0.65s both;
        }

        .metrics-section h3 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            font-size: 0.85rem;
            color: var(--sunshine-gold);
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .metrics-grid {
            display: grid;
            gap: 1rem;
        }

        .metric-item {
            text-align: center;
        }

        .metric-value {
            font-family: 'Montserrat', sans-serif;
            font-weight: 800;
            font-size: 1.5rem;
            color: var(--sunshine-gold);
            margin-bottom: 0.25rem;
            display: flex;
            justify-content: center;
            align-items: baseline;
            gap: 2px;
        }

        .metric-prefix {
            font-size: 1rem;
        }

        .metric-suffix {
            font-size: 0.9rem;
            font-weight: 600;
        }

        .metric-label {
            font-size: 0.7rem;
            color: var(--cream);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            opacity: 0.9;
        }

        .metric-number {
            display: inline-block;
            min-width: 1ch;
        }

        @keyframes countUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .metric-value.counting .metric-number {
            animation: countUp 0.1s ease-out;
        }

        /* Pulse dot for "live" indicator */
        .live-dot {
            width: 8px;
            height: 8px;
            background: #4ade80;
            border-radius: 50%;
            animation: livePulse 2s ease-in-out infinite;
        }

        @keyframes livePulse {
            0%, 100% {
                opacity: 1;
                box-shadow: 0 0 0 0 rgba(74, 222, 128, 0.7);
            }
            50% {
                opacity: 0.8;
                box-shadow: 0 0 0 6px rgba(74, 222, 128, 0);
            }
        }

        /* Scenic Route Toggle */
        .route-toggle-section {
            margin-bottom: 1.5rem;
            animation: fadeInUp 0.6s ease-out 0.55s both;
        }

        .route-toggle-section h3 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 0.75rem;
            color: var(--deep-brown);
        }

        .route-toggle {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.6rem 0.75rem;
            background: linear-gradient(135deg, var(--sunshine-gold) 0%, var(--amber) 100%);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .route-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(234, 192, 84, 0.4);
        }

        .route-toggle input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--deep-brown);
        }

        .route-toggle label {
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--deep-brown);
        }

        .route-info {
            font-size: 0.75rem;
            color: #555;
            margin-top: 0.5rem;
            line-height: 1.4;
        }

        /* Route Legend */
        .route-legend {
            display: flex;
            flex-direction: column;
            gap: 0.4rem;
            margin-top: 0.75rem;
            padding: 0.75rem;
            background: var(--light-gold);
            border-radius: 6px;
        }

        .route-legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.75rem;
        }

        .route-line {
            width: 24px;
            height: 4px;
            border-radius: 2px;
        }

        .route-line.blue-ridge {
            background: linear-gradient(90deg, #2E86AB, #4ECDC4);
        }

        .route-line.skyline {
            background: linear-gradient(90deg, #7B68EE, #9370DB);
        }

        .route-line.route-100 {
            background: linear-gradient(90deg, #228B22, #32CD32);
        }

        .route-line.connector {
            background: #888;
            border-style: dashed;
        }
    </style>
</head>
<body>
    <header>
        <div class="logo-section">
            <div>
                <h1>The <span>Sunshine</span> Trail</h1>
                <p class="tagline">Mountain communities. Outdoor adventures. Cold beer.</p>
            </div>
        </div>
        <a href="https://www.lawsonsfinest.com" target="_blank" rel="noopener noreferrer" class="brand-logo-link">
            <img src="assets/images/lawsons-logo.svg" alt="Lawson's Finest Liquids" class="header-brand-logo">
        </a>
    </header>

    <main>
        <aside class="sidebar">
            <p class="intro-text">
                Explore the <strong>Sunshine Spots</strong> from Waitsfield, Vermont to Asheville, North Carolina.
                Discover retailers, hiking trails, river put-ins, and the community organizations we support along the way.
            </p>

            <div class="metrics-section">
                <h3><span class="live-dot"></span> Our Impact</h3>
                <div class="metrics-grid">
                    <div class="metric-item">
                        <div class="metric-value" id="metric-donated">
                            <span class="metric-prefix">$</span>
                            <span class="metric-number" data-target="3000000">0</span>
                            <span class="metric-suffix">+</span>
                        </div>
                        <div class="metric-label">Donated to 400+ Nonprofits</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="metric-solar">
                            <span class="metric-number" data-target="570000">0</span>
                            <span class="metric-suffix"> kWh</span>
                        </div>
                        <div class="metric-label">Solar Energy Annually</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-value" id="metric-waste">
                            <span class="metric-number" data-target="97.2" data-decimal="true">0</span>
                            <span class="metric-suffix">%</span>
                        </div>
                        <div class="metric-label">Waste Diverted from Landfill</div>
                    </div>
                </div>
            </div>

            <div class="filter-section">
                <h3>Filter by Category</h3>
                <div class="filter-group">
                    <div class="filter-item">
                        <input type="checkbox" id="filter-retailers" checked>
                        <label for="filter-retailers">
                            <img src="assets/images/marker-retailer.png" alt="" class="filter-icon">
                            Retailers
                            <span class="count-badge" id="count-retailers">0</span>
                        </label>
                    </div>
                    <div class="filter-item">
                        <input type="checkbox" id="filter-trails" checked>
                        <label for="filter-trails">
                            <img src="assets/images/marker-trail.png" alt="" class="filter-icon">
                            Trails
                            <span class="count-badge" id="count-trails">0</span>
                        </label>
                    </div>
                    <div class="filter-item">
                        <input type="checkbox" id="filter-rivers" checked>
                        <label for="filter-rivers">
                            <img src="assets/images/marker-river.png" alt="" class="filter-icon">
                            River Put-ins
                            <span class="count-badge" id="count-rivers">0</span>
                        </label>
                    </div>
                    <div class="filter-item">
                        <input type="checkbox" id="filter-community" checked>
                        <label for="filter-community">
                            <img src="assets/images/marker-community.png" alt="" class="filter-icon">
                            Community Partners
                            <span class="count-badge" id="count-community">0</span>
                        </label>
                    </div>
                    <div class="filter-item">
                        <input type="checkbox" id="filter-chargers" checked>
                        <label for="filter-chargers">
                            <img src="assets/images/marker-charger.svg" alt="" class="filter-icon">
                            DC Fast Chargers
                            <span class="count-badge" id="count-chargers">0</span>
                        </label>
                    </div>
                </div>
            </div>

            <div class="route-toggle-section">
                <h3>Scenic Road Trip Route</h3>
                <div class="route-toggle">
                    <input type="checkbox" id="toggle-scenic-route">
                    <label for="toggle-scenic-route">Show The Sunshine Trail Route</label>
                </div>
                <p class="route-info">The ultimate road trip from Asheville, NC to Waitsfield, VT via America's most scenic mountain roads.</p>
                <div class="route-legend" id="route-legend" style="display: none;">
                    <div class="route-legend-item">
                        <span class="route-line blue-ridge"></span>
                        <span>Blue Ridge Parkway (469 mi)</span>
                    </div>
                    <div class="route-legend-item">
                        <span class="route-line skyline"></span>
                        <span>Skyline Drive (105 mi)</span>
                    </div>
                    <div class="route-legend-item">
                        <span class="route-line connector"></span>
                        <span>I-81 / US-7 Connector</span>
                    </div>
                    <div class="route-legend-item">
                        <span class="route-line route-100"></span>
                        <span>VT Route 100 (217 mi)</span>
                    </div>
                </div>
            </div>

            <div class="state-filter-section">
                <h3>Community Partners by State</h3>
                <div class="state-buttons">
                    <button class="state-btn all-states active" data-state="all">All States</button>
                    <button class="state-btn" data-state="VT">VT</button>
                    <button class="state-btn" data-state="NH">NH</button>
                    <button class="state-btn" data-state="ME">ME</button>
                    <button class="state-btn" data-state="MA">MA</button>
                    <button class="state-btn" data-state="RI">RI</button>
                    <button class="state-btn" data-state="CT">CT</button>
                    <button class="state-btn" data-state="NY">NY</button>
                    <button class="state-btn" data-state="NJ">NJ</button>
                    <button class="state-btn" data-state="PA">PA</button>
                    <button class="state-btn" data-state="VA">VA</button>
                    <button class="state-btn" data-state="NC">NC</button>
                </div>
            </div>

            <div class="legend">
                <h4>About This Trail</h4>
                <p>
                    The Sunshine Trail celebrates the shared culture of mountain communities along the East Coast -
                    from the Green Mountains of Vermont to the Blue Ridge of North Carolina.
                    Every spot on this map represents our commitment to quality, community, and the great outdoors.
                </p>
            </div>
        </aside>

        <div id="map" role="application" aria-label="Interactive map of Sunshine Trail locations from Vermont to North Carolina"></div>
    </main>

    <footer class="footer-bar">
        <div class="footer-content">
            <span class="footer-tagline">Finest. Freshest. Always Kept Cold.&trade;</span>
            <a href="https://www.lawsonsfinest.com" target="_blank" rel="noopener noreferrer" class="footer-link">lawsonsfinest.com</a>
            <img src="assets/images/b-corp-logo.png" alt="Certified B Corporation" class="footer-bcorp">
        </div>
    </footer>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin="anonymous"></script>
    <script>
        // Initialize the map with smooth scrolling and animations
        const map = L.map('map', {
            center: [39.5, -77.5],
            zoom: 6,
            zoomControl: true,
            scrollWheelZoom: true,
            zoomSnap: 0.1,              // Allow finer zoom levels
            zoomDelta: 0.25,            // Smaller zoom steps for smoother feel
            wheelPxPerZoomLevel: 100,   // More wheel movement per zoom level
            wheelDebounceTime: 40,      // Responsive wheel zoom
            zoomAnimation: true,
            fadeAnimation: true,
            markerZoomAnimation: true,
            inertia: true,
            inertiaDeceleration: 2000,  // Smooth deceleration
            inertiaMaxSpeed: 2000,
            easeLinearity: 0.2,         // Smoother easing
            tap: true,
            touchZoom: true,
            doubleClickZoom: true,
            boxZoom: true
        });

        // Add a styled tile layer with smooth transitions
        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
            subdomains: 'abcd',
            maxZoom: 19,
            updateWhenZooming: false,
            updateWhenIdle: true,
            keepBuffer: 4
        }).addTo(map);

        // Define marker icons - using custom images with correct dimensions
        const markerIcons = {
            retailer: L.icon({
                iconUrl: 'assets/images/marker-retailer.png',
                iconSize: [40, 37],
                iconAnchor: [20, 37],
                popupAnchor: [0, -37],
                className: 'marker-icon'
            }),
            trail: L.icon({
                iconUrl: 'assets/images/marker-trail.png',
                iconSize: [32, 48],
                iconAnchor: [16, 48],
                popupAnchor: [0, -48],
                className: 'marker-icon'
            }),
            river: L.icon({
                iconUrl: 'assets/images/marker-river.png',
                iconSize: [32, 48],
                iconAnchor: [16, 48],
                popupAnchor: [0, -48],
                className: 'marker-icon'
            }),
            community: L.icon({
                iconUrl: 'assets/images/marker-community.png',
                iconSize: [40, 40],
                iconAnchor: [20, 40],
                popupAnchor: [0, -40],
                className: 'marker-icon'
            }),
            charger: L.icon({
                iconUrl: 'assets/images/marker-charger.svg',
                iconSize: [32, 40],
                iconAnchor: [16, 40],
                popupAnchor: [0, -40],
                className: 'marker-icon'
            })
        };

        // Get marker icon for category
        function createMarkerIcon(category) {
            return markerIcons[category];
        }

        // Sunshine Trail Data
        const sunshineSpots = [
            // === RETAILERS ===
            // Vermont
            {
                name: "Lawson's Finest Liquids Taproom",
                category: "retailer",
                lat: 44.1852,
                lng: -72.8288,
                location: "Waitsfield, VT",
                description: "The home of Sip of Sunshine. Visit our taproom for the freshest pours and exclusive releases.",
                url: "https://www.lawsonsfinest.com"
            },
            {
                name: "Mad River Taste Place",
                category: "retailer",
                lat: 44.1870,
                lng: -72.8256,
                location: "Waitsfield, VT",
                description: "The Valley's go-to destination for Vermont craft beer, local cider, wine, and hyper-local spirits.",
                url: "https://madrivervalley.com"
            },
            {
                name: "Mehuron's Supermarket",
                category: "retailer",
                lat: 44.1858,
                lng: -72.8271,
                location: "Waitsfield, VT",
                description: "Local grocery with an excellent Vermont craft beer selection including Lawson's Finest.",
                url: null
            },
            {
                name: "JD's Quick Stop",
                category: "retailer",
                lat: 43.9289,
                lng: -72.8411,
                location: "Hancock, VT",
                description: "Famous beer cave with a curated selection of Vermont's finest including Lawson's, Heady Topper, and more.",
                url: null
            },
            // Massachusetts
            {
                name: "Craft Beer Cellar - Belmont",
                category: "retailer",
                lat: 42.3962,
                lng: -71.1784,
                location: "Belmont, MA",
                description: "Premier craft beer retailer featuring rotating selections from Lawson's Finest Liquids.",
                url: "https://craftbeercellar.com"
            },
            {
                name: "Blanchard's Liquors",
                category: "retailer",
                lat: 42.3151,
                lng: -71.0589,
                location: "Boston, MA",
                description: "Boston's destination for craft beer with regular Lawson's Finest availability.",
                url: null
            },
            // Connecticut
            {
                name: "Two Roads Brewing Company",
                category: "retailer",
                lat: 41.2226,
                lng: -73.1353,
                location: "Stratford, CT",
                description: "Our brewing partner - Sip of Sunshine is brewed here. Visit the taproom for fresh pours.",
                url: "https://tworoadsbrewing.com"
            },
            // New York
            {
                name: "Whole Foods Market - Union Square",
                category: "retailer",
                lat: 40.7359,
                lng: -73.9911,
                location: "New York, NY",
                description: "Quality craft beer selection in Manhattan including Lawson's Finest offerings.",
                url: null
            },
            // Pennsylvania
            {
                name: "Monk's Cafe",
                category: "retailer",
                lat: 39.9478,
                lng: -75.1639,
                location: "Philadelphia, PA",
                description: "Legendary Philadelphia beer bar known for exceptional craft selections.",
                url: "https://monkscafe.com"
            },
            {
                name: "Tired Hands Brewing Company",
                category: "retailer",
                lat: 40.0054,
                lng: -75.3099,
                location: "Ardmore, PA",
                description: "Award-winning brewery and fermentaria with rotating guest taps.",
                url: "https://tiredhands.com"
            },
            // Virginia
            {
                name: "Total Wine & More - Richmond",
                category: "retailer",
                lat: 37.5955,
                lng: -77.5201,
                location: "Richmond, VA",
                description: "Extensive craft beer selection with regular Lawson's Finest availability.",
                url: "https://totalwine.com"
            },
            {
                name: "The Veil Brewing Co.",
                category: "retailer",
                lat: 37.5541,
                lng: -77.4599,
                location: "Richmond, VA",
                description: "Richmond's favorite brewery - check for Lawson's guest taps and events.",
                url: "https://theveilbrewing.com"
            },
            // North Carolina
            {
                name: "Weinhaus",
                category: "retailer",
                lat: 35.5951,
                lng: -82.5515,
                location: "Asheville, NC",
                description: "Downtown Asheville's oldest and largest bottle shop with 12 local NC beers on tap.",
                url: "https://weinhaus.com"
            },
            {
                name: "Local 604 Bottle Shop - West",
                category: "retailer",
                lat: 35.5847,
                lng: -82.5760,
                location: "Asheville, NC",
                description: "West Asheville's best little bottle shop with over 20 local breweries represented.",
                url: "https://local604avl.com"
            },
            {
                name: "The Whale - A Craft Beer Collective",
                category: "retailer",
                lat: 35.5943,
                lng: -82.5540,
                location: "Asheville, NC",
                description: "Exceptional craft beer selection - one of the best bottle shops on the East Coast.",
                url: null
            },
            {
                name: "Appalachian Vintner",
                category: "retailer",
                lat: 35.6012,
                lng: -82.5568,
                location: "Asheville, NC",
                description: "Great selection and one-stop shopping for beer and wine in Asheville.",
                url: null
            },
            // Additional Vermont Retailers
            {
                name: "Cold Hollow Cider Mill",
                category: "retailer",
                lat: 44.3856,
                lng: -72.7469,
                location: "Waterbury, VT",
                description: "Iconic Vermont destination with craft beer, fresh cider donuts, and local products. A Route 100 must-stop.",
                url: "https://coldhollow.com"
            },
            {
                name: "Stowe Public House",
                category: "retailer",
                lat: 44.4654,
                lng: -72.6874,
                location: "Stowe, VT",
                description: "Classic Vermont tavern with an excellent rotating craft beer selection including Lawson's Finest.",
                url: null
            },
            // Additional New Hampshire
            {
                name: "Bert's Better Beers",
                category: "retailer",
                lat: 42.9956,
                lng: -71.4548,
                location: "Hooksett, NH",
                description: "New Hampshire's premier craft beer destination with 1,200+ craft beers. Consistently stocks Lawson's.",
                url: "https://bertsbetterbeers.com"
            },
            // Additional Massachusetts
            {
                name: "Yankee Spirits",
                category: "retailer",
                lat: 42.0834,
                lng: -71.0184,
                location: "Attleboro, MA",
                description: "Award-winning liquor store chain with extensive craft beer selection including Lawson's Finest.",
                url: "https://yankeespirits.com"
            },
            {
                name: "Stop & Shop - Boston",
                category: "retailer",
                lat: 42.3467,
                lng: -71.0972,
                location: "Boston, MA",
                description: "Major grocery chain carrying Lawson's Sip of Sunshine in 4-packs. Cold stored for freshness.",
                url: "https://stopandshop.com"
            },
            {
                name: "Gordon's Fine Wines & Liquors",
                category: "retailer",
                lat: 42.4501,
                lng: -71.2326,
                location: "Waltham, MA",
                description: "Family-owned since 1936. Excellent craft beer cave with rotating Lawson's selections.",
                url: "https://gordonswine.com"
            },
            // Additional Connecticut
            {
                name: "Craft Beer Shop - New Haven",
                category: "retailer",
                lat: 41.3083,
                lng: -72.9279,
                location: "New Haven, CT",
                description: "Dedicated craft beer bottle shop in the heart of New Haven. Fresh Lawson's regularly in stock.",
                url: null
            },
            // Additional New York
            {
                name: "Half Time Beverage",
                category: "retailer",
                lat: 41.0255,
                lng: -73.7618,
                location: "Mamaroneck, NY",
                description: "Legendary NY craft beer destination with 2,000+ beers. A bucket-list stop for beer lovers.",
                url: "https://halftimebeverage.com"
            },
            {
                name: "Whole Foods Market - Brooklyn",
                category: "retailer",
                lat: 40.6892,
                lng: -73.9785,
                location: "Brooklyn, NY",
                description: "Fort Greene location with curated craft beer selection including Lawson's Sip of Sunshine.",
                url: "https://wholefoodsmarket.com"
            },
            {
                name: "Wegmans - Rochester",
                category: "retailer",
                lat: 43.1166,
                lng: -77.6088,
                location: "Rochester, NY",
                description: "The original Wegmans location with an exceptional beer department. Lawson's regularly stocked.",
                url: "https://wegmans.com"
            },
            // Additional New Jersey
            {
                name: "Wegmans - Princeton",
                category: "retailer",
                lat: 40.3176,
                lng: -74.6532,
                location: "Princeton, NJ",
                description: "Premium grocery with outstanding craft beer selection and cold storage. Fresh Lawson's available.",
                url: "https://wegmans.com"
            },
            {
                name: "Buy Rite Liquors - Jersey City",
                category: "retailer",
                lat: 40.7282,
                lng: -74.0776,
                location: "Jersey City, NJ",
                description: "Well-stocked craft beer selection with regular Lawson's Finest availability.",
                url: null
            },
            // Additional Pennsylvania
            {
                name: "ACME Markets - Wayne",
                category: "retailer",
                lat: 40.0439,
                lng: -75.3879,
                location: "Wayne, PA",
                description: "Full-service grocery with craft beer section featuring Lawson's Sip of Sunshine.",
                url: "https://acmemarkets.com"
            },
            {
                name: "Wegmans - King of Prussia",
                category: "retailer",
                lat: 40.0878,
                lng: -75.3889,
                location: "King of Prussia, PA",
                description: "Expansive beer department with dedicated craft section. Lawson's kept cold for optimal freshness.",
                url: "https://wegmans.com"
            },
            // Additional Virginia
            {
                name: "Corks & Kegs - Leesburg",
                category: "retailer",
                lat: 39.1157,
                lng: -77.5636,
                location: "Leesburg, VA",
                description: "Northern Virginia craft beer destination with 500+ craft selections including Lawson's.",
                url: null
            },
            {
                name: "Whole Foods Market - Fairfax",
                category: "retailer",
                lat: 38.8462,
                lng: -77.3064,
                location: "Fairfax, VA",
                description: "Fresh Lawson's on draft and in cans. Part of their curated Virginia craft beer program.",
                url: "https://wholefoodsmarket.com"
            },
            {
                name: "Beer Run - Charlottesville",
                category: "retailer",
                lat: 38.0293,
                lng: -78.4767,
                location: "Charlottesville, VA",
                description: "Craft beer bar and bottle shop near UVA. Fresh Lawson's in cans with rotating draft selections.",
                url: "https://beerrun.com"
            },
            {
                name: "Staunton Grocery",
                category: "retailer",
                lat: 38.1496,
                lng: -79.0717,
                location: "Staunton, VA",
                description: "Boutique grocery in the Shenandoah Valley with craft beer selection. Near Skyline Drive.",
                url: null
            },
            // Additional North Carolina
            {
                name: "Tasty Beverage Co.",
                category: "retailer",
                lat: 35.7721,
                lng: -78.6386,
                location: "Raleigh, NC",
                description: "Raleigh's premier craft beer bottle shop with 1,000+ selections. Fresh Lawson's available.",
                url: "https://tastybeverageco.com"
            },
            {
                name: "Good Bottle Co.",
                category: "retailer",
                lat: 35.2106,
                lng: -80.8308,
                location: "Charlotte, NC",
                description: "South End Charlotte's neighborhood bottle shop with curated craft selections including Lawson's.",
                url: "https://goodbottleco.com"
            },
            {
                name: "Craft - Asheville",
                category: "retailer",
                lat: 35.5923,
                lng: -82.5574,
                location: "Asheville, NC",
                description: "Grove Arcade location with rotating craft beer and fresh Lawson's from Artisan Beverage Group.",
                url: null
            },
            // Rhode Island
            {
                name: "Nikki's Liquors",
                category: "retailer",
                lat: 41.8240,
                lng: -71.4128,
                location: "Providence, RI",
                description: "Providence's go-to craft beer destination. Extensive selection with regular Lawson's stock.",
                url: "https://nikkisliquors.com"
            },
            // Maine
            {
                name: "RSVP Discount Beverage",
                category: "retailer",
                lat: 43.6591,
                lng: -70.2568,
                location: "Portland, ME",
                description: "Portland's largest beer selection with 1,500+ craft beers. Fresh Lawson's in the cooler.",
                url: "https://rsvpdiscountbeverage.com"
            },

            // === TRAILS ===
            // Vermont
            {
                name: "Camel's Hump via Long Trail",
                category: "trail",
                lat: 44.3198,
                lng: -72.8862,
                location: "Duxbury, VT",
                description: "Vermont's most iconic mountain with 360-degree views. 6.8 miles round trip. One of only four peaks in Vermont with alpine tundra.",
                url: "https://www.alltrails.com/trail/us/vermont/camels-hump-via-long-trail-and-burrows-trail"
            },
            {
                name: "Stratton Mountain",
                category: "trail",
                lat: 43.0822,
                lng: -72.9089,
                location: "Stratton, VT",
                description: "Where Benton MacKaye conceived the Appalachian Trail. Features peaceful streams, meadows, and pristine Stratton Pond.",
                url: "https://www.alltrails.com/trail/us/vermont/stratton-mountain-and-stratton-pond-via-long-trail"
            },
            {
                name: "Mount Mansfield - Long Trail",
                category: "trail",
                lat: 44.5437,
                lng: -72.8143,
                location: "Stowe, VT",
                description: "Vermont's highest peak at 4,393 ft. Stunning ridge walk along 'The Chin' with alpine scenery.",
                url: "https://www.alltrails.com/trail/us/vermont/mount-mansfield-via-sunset-ridge-and-long-trail"
            },
            // New Hampshire
            {
                name: "Franconia Ridge Loop",
                category: "trail",
                lat: 44.1604,
                lng: -71.6447,
                location: "Franconia, NH",
                description: "One of the premier day hikes in the entire country. Above-treeline ridge walk with 360-degree views. 8.9 miles.",
                url: "https://www.alltrails.com/trail/us/new-hampshire/franconia-ridge-trail-loop"
            },
            {
                name: "Mount Washington via Tuckerman Ravine",
                category: "trail",
                lat: 44.2706,
                lng: -71.3033,
                location: "Pinkham Notch, NH",
                description: "The Northeast's highest peak at 6,288 ft. Historic and challenging. Once held the world wind speed record.",
                url: "https://www.alltrails.com/trail/us/new-hampshire/mount-washington-via-tuckerman-ravine-trail"
            },
            // Massachusetts
            {
                name: "Mount Greylock - Appalachian Trail",
                category: "trail",
                lat: 42.6376,
                lng: -73.1662,
                location: "Adams, MA",
                description: "Massachusetts' highest point at 3,491 ft. The AT passes over the summit with panoramic views of five states.",
                url: "https://www.alltrails.com/trail/us/massachusetts/mount-greylock-via-hopper-trail"
            },
            {
                name: "Taconic Highlands - Mount Everett",
                category: "trail",
                lat: 42.0977,
                lng: -73.4374,
                location: "Mount Washington, MA",
                description: "A 17-mile AT section with old-growth forest, waterfalls, and open summits without crossing a single road.",
                url: "https://www.alltrails.com/trail/us/massachusetts/mount-everett-via-appalachian-trail"
            },
            // Pennsylvania
            {
                name: "Hawk Mountain Sanctuary",
                category: "trail",
                lat: 40.6359,
                lng: -75.9871,
                location: "Kempton, PA",
                description: "World-renowned raptor migration site. Over 20,000 hawks fly over each fall. Multiple scenic overlooks.",
                url: "https://www.hawkmountain.org/visit/plan-your-visit"
            },
            {
                name: "The Pinnacle",
                category: "trail",
                lat: 40.5805,
                lng: -75.9143,
                location: "Hamburg, PA",
                description: "Considered by many to be the AT's best view in Pennsylvania. 9-mile loop with stunning rock formations.",
                url: "https://www.alltrails.com/trail/us/pennsylvania/pinnacle-and-pulpit-rock-loop-via-appalachian-trail"
            },
            // Virginia
            {
                name: "McAfee Knob",
                category: "trail",
                lat: 37.2390,
                lng: -80.0328,
                location: "Salem, VA",
                description: "The most photographed spot on the entire Appalachian Trail. Iconic rock outcrop with widescreen mountain views. 8.8 miles.",
                url: "https://www.alltrails.com/trail/us/virginia/mcafee-knob-via-appalachian-trail"
            },
            {
                name: "Three Ridges Wilderness",
                category: "trail",
                lat: 37.9189,
                lng: -79.0168,
                location: "Waynesboro, VA",
                description: "Scenic views, 40-foot waterfalls, and swimming holes. A challenging but rewarding AT section.",
                url: "https://www.alltrails.com/trail/us/virginia/three-ridges-via-appalachian-trail"
            },
            {
                name: "Old Rag Mountain",
                category: "trail",
                lat: 38.5533,
                lng: -78.3161,
                location: "Shenandoah NP, VA",
                description: "Virginia's most popular hike. Iconic rock scramble with 360-degree views from the summit.",
                url: "https://www.alltrails.com/trail/us/virginia/old-rag-mountain-loop-trail"
            },
            // North Carolina
            {
                name: "Max Patch",
                category: "trail",
                lat: 35.7972,
                lng: -82.9569,
                location: "Hot Springs, NC",
                description: "A rolling, grassy mountaintop bald with endless wildflowers and stunning 360-degree panoramas. One of our favorites on the AT.",
                url: "https://www.alltrails.com/trail/us/north-carolina/max-patch-loop-trail"
            },
            {
                name: "Roan Highlands - Carvers Gap",
                category: "trail",
                lat: 36.1064,
                lng: -82.1098,
                location: "Roan Mountain, NC/TN",
                description: "Rolling balds with fields of wildflowers. Hike to Round Bald, Jane Bald, and Grassy Ridge for incredible views.",
                url: "https://www.alltrails.com/trail/us/north-carolina/grassy-ridge-bald-via-appalachian-trail"
            },
            {
                name: "Craggy Gardens",
                category: "trail",
                lat: 35.7019,
                lng: -82.3790,
                location: "Blue Ridge Parkway, NC",
                description: "Famous for rhododendron blooms. Easy to moderate trails with panoramic Blue Ridge views.",
                url: "https://www.alltrails.com/trail/us/north-carolina/craggy-gardens-trail"
            },
            {
                name: "Looking Glass Rock",
                category: "trail",
                lat: 35.2957,
                lng: -82.7877,
                location: "Pisgah NF, NC",
                description: "Iconic granite dome near Brevard. Challenging 6.5-mile hike rewarded with spectacular views.",
                url: "https://www.alltrails.com/trail/us/north-carolina/looking-glass-rock-trail"
            },

            // === RIVER PUT-INS ===
            // Vermont
            {
                name: "Mad River - Waitsfield Access",
                category: "river",
                lat: 44.1892,
                lng: -72.8301,
                location: "Waitsfield, VT",
                description: "Local favorite for kayaking and swimming. Class I-II rapids through the heart of the Mad River Valley.",
                url: "https://www.clearwatervt.com/trips"
            },
            {
                name: "White River - Chelsea Park",
                category: "river",
                lat: 43.7832,
                lng: -72.4689,
                location: "Sharon, VT",
                description: "Vermont's longest undammed river. Popular put-in for scenic day paddles with few portages required.",
                url: "https://www.vermontpaddlers.club/white-river"
            },
            {
                name: "Connecticut River - Wilgus State Park",
                category: "river",
                lat: 43.4397,
                lng: -72.4128,
                location: "Ascutney, VT",
                description: "Canoe and kayak rentals available. Part of the 400-mile Connecticut River Paddlers' Trail.",
                url: "https://www.connecticutriverpaddlerstrail.org"
            },
            // New Hampshire
            {
                name: "Connecticut River - Hanover",
                category: "river",
                lat: 43.7022,
                lng: -72.2896,
                location: "Hanover, NH",
                description: "Easy access point on New England's longest river. Beautiful paddling through scenic Upper Valley.",
                url: "https://www.ledyardcanoeclub.org"
            },
            // Virginia
            {
                name: "James River - Buchanan",
                category: "river",
                lat: 37.5275,
                lng: -79.6787,
                location: "Buchanan, VA",
                description: "Upper James River Water Trail access. 64 miles of paddling through the Allegheny and Blue Ridge Mountains.",
                url: "https://www.upperjamesriverwatertrail.com"
            },
            {
                name: "Roanoke River Blueway - Wasena Park",
                category: "river",
                lat: 37.2620,
                lng: -79.9571,
                location: "Roanoke, VA",
                description: "Voted one of the best urban kayaking spots in the US. Easy float through Virginia's Blue Ridge.",
                url: "https://www.roanokecountyparks.com/283/Roanoke-River-Blueway"
            },
            {
                name: "New River - McCoy Access",
                category: "river",
                lat: 37.2419,
                lng: -80.6009,
                location: "Giles County, VA",
                description: "Start of the 37-mile New River Water Trail. Class I to III rapids through stunning mountain scenery.",
                url: "https://www.newriverwatertrail.com"
            },
            // North Carolina
            {
                name: "French Broad River - Asheville",
                category: "river",
                lat: 35.5707,
                lng: -82.5779,
                location: "Asheville, NC",
                description: "The heart of Asheville's outdoor scene. Multiple access points for tubing, kayaking, and paddleboarding.",
                url: "https://www.ashevilleoutdoorcenter.com"
            },
            {
                name: "French Broad River - Headwaters",
                category: "river",
                lat: 35.1430,
                lng: -82.8256,
                location: "Rosman, NC",
                description: "Headwaters Outfitters offers 3-7 hour self-guided trips. Pristine paddling southwest of Asheville.",
                url: "https://www.headwatersoutfitters.com"
            },
            {
                name: "Yadkin River - Surry County",
                category: "river",
                lat: 36.4117,
                lng: -80.6776,
                location: "Elkin, NC",
                description: "Over 100 miles of canoe/kayak waters. Surry County has more river access points than any other NC county.",
                url: "https://www.yadkinriverbluetrail.com"
            },

            // === COMMUNITY PARTNERS ===
            // Verified Lawson's Finest Liquids donation recipients from Cosmic Shift IPA,
            // Sunshine Fund, GivingTuesday, and Good Brews for a Cause programs.
            // Total: $3M+ donated to 400+ nonprofits since 2018.

            // VERMONT - Sunshine Fund & Home State Partners
            {
                name: "Vermont Foodbank",
                category: "community",
                state: "VT",
                lat: 44.2004,
                lng: -72.5073,
                location: "Barre, VT",
                description: "Vermont's largest hunger-relief organization, serving all 14 counties through a network of food shelves, meal sites, and community programs.",
                impact: "Thanks to support from Lawson's Cosmic Shift IPA, families like the Martins in rural Vermont can count on fresh produce and protein each week. 'After my husband's job loss, the food shelf kept our kids fed while we got back on our feet.'",
                image: "https://images.unsplash.com/photo-1593113598332-cd288d649433?w=400&h=200&fit=crop",
                url: "https://vtfoodbank.org",
                donateUrl: "https://vtfoodbank.org/give"
            },
            {
                name: "Upper Valley Haven",
                category: "community",
                state: "VT",
                lat: 43.6489,
                lng: -72.3212,
                location: "White River Junction, VT",
                description: "Providing food, shelter, education, and service coordination for families and individuals in need in the Upper Valley.",
                impact: "2024 Sunshine Fund recipient. The Haven helped Sarah, a single mom, transition from their shelter to stable housing. 'They didn't just give me a roof - they helped me build a future for my daughter.'",
                image: "https://images.unsplash.com/photo-1532629345422-7515f3d16bb6?w=400&h=200&fit=crop",
                url: "https://uppervalleyhaven.org",
                donateUrl: "https://uppervalleyhaven.org/donate"
            },
            {
                name: "Committee on Temporary Shelter (COTS)",
                category: "community",
                state: "VT",
                lat: 44.4759,
                lng: -73.2121,
                location: "Burlington, VT",
                description: "Working to end homelessness in Vermont through shelter, housing, and prevention services since 1982.",
                impact: "2024 Sunshine Fund recipient. Last winter, COTS helped 47 people find permanent housing. James, a veteran, says: 'COTS gave me more than shelter. They gave me back my dignity and a place to call home.'",
                image: "https://images.unsplash.com/photo-1469571486292-0ba58a3f068b?w=400&h=200&fit=crop",
                url: "https://cotsonline.org",
                donateUrl: "https://cotsonline.org/donate"
            },
            {
                name: "Green Mountain Farm-to-School",
                category: "community",
                state: "VT",
                lat: 44.0354,
                lng: -73.1795,
                location: "Newport, VT",
                description: "Connecting Vermont farms with schools to provide fresh, local food while teaching kids about nutrition and agriculture.",
                impact: "2024 Sunshine Fund recipient. Thanks to their programs, students in Orleans County now grow vegetables in school gardens. Teacher Amy shares: 'Kids who never touched a vegetable are now excited to eat what they planted.'",
                image: "https://images.unsplash.com/photo-1574943320219-553eb213f72d?w=400&h=200&fit=crop",
                url: "https://greenmountainfarmtoschool.org",
                donateUrl: "https://greenmountainfarmtoschool.org/donate"
            },
            {
                name: "Friends of the Winooski River",
                category: "community",
                state: "VT",
                lat: 44.4875,
                lng: -72.8899,
                location: "Montpelier, VT",
                description: "Protecting and restoring the Winooski River watershed through education, advocacy, and community engagement.",
                impact: "2024 Sunshine Fund recipient. Their river cleanup events have removed tons of debris while educating hundreds of volunteers. 'Every paddle on the Winooski is cleaner because of their work,' says kayaker Tom.",
                image: "https://images.unsplash.com/photo-1504893524553-b855bce32c67?w=400&h=200&fit=crop",
                url: "https://winooskiriver.org",
                donateUrl: "https://winooskiriver.org/donate"
            },
            {
                name: "Vermont Community Foundation",
                category: "community",
                state: "VT",
                lat: 44.2598,
                lng: -72.5754,
                location: "Middlebury, VT",
                description: "Partner for the inaugural SIPosium, supporting Vermont's flood recovery and building community resilience across the state.",
                impact: "After devastating floods, the Foundation mobilized rapid response grants. Homeowner Maria recalls: 'Within days of losing everything, we had help rebuilding. The Vermont spirit is real.'",
                image: "https://images.unsplash.com/photo-1559027615-cd4628902d4a?w=400&h=200&fit=crop",
                url: "https://vermontcf.org",
                donateUrl: "https://vermontcf.org/give"
            },
            {
                name: "Northeast Kingdom Community Action (NEKCA)",
                category: "community",
                state: "VT",
                lat: 44.5342,
                lng: -72.0196,
                location: "St. Johnsbury, VT",
                description: "Fighting poverty and building community in Vermont's Northeast Kingdom through comprehensive support services.",
                impact: "2024 Sunshine Fund recipient. NEKCA's heating assistance kept 200+ families warm last winter. 'Choosing between heat and food shouldn't happen in Vermont,' says director Lisa. 'We make sure it doesn't.'",
                image: "https://images.unsplash.com/photo-1488521787991-ed7bbaae773c?w=400&h=200&fit=crop",
                url: "https://nekcavt.org",
                donateUrl: "https://nekcavt.org/donate"
            },

            // NEW HAMPSHIRE - Cosmic Shift Beneficiary
            {
                name: "NH Food Alliance",
                category: "community",
                state: "NH",
                lat: 43.2081,
                lng: -71.5376,
                location: "Concord, NH",
                description: "Building a thriving, fair, and sustainable food system in New Hampshire by connecting farmers, food banks, and communities.",
                impact: "Cosmic Shift IPA beneficiary. The Alliance helped launch 12 new farm-to-food-bank partnerships. Farmer Jake says: 'Now my extra harvest feeds families instead of going to waste. It's farming with purpose.'",
                image: "https://images.unsplash.com/photo-1500937386664-56d1dfef3854?w=400&h=200&fit=crop",
                url: "https://nhfoodalliance.org",
                donateUrl: "https://nhfoodalliance.org/donate"
            },

            // MAINE - Cosmic Shift Beneficiary
            {
                name: "Cultivating Community",
                category: "community",
                state: "ME",
                lat: 43.6591,
                lng: -70.2568,
                location: "Portland, ME",
                description: "Growing food, farmers, and community through urban agriculture programs that serve immigrant and refugee communities.",
                impact: "Cosmic Shift IPA beneficiary. Their refugee farming program has helped 50+ families grow food from their homelands. Amara, from Somalia, shares: 'This garden connects me to home while feeding my children here.'",
                image: "https://images.unsplash.com/photo-1416879595882-3373a0480b5b?w=400&h=200&fit=crop",
                url: "https://cultivatingcommunity.org",
                donateUrl: "https://cultivatingcommunity.org/donate"
            },

            // MASSACHUSETTS - Cosmic Shift Beneficiary
            {
                name: "Spoonfuls (Lovin' Spoonfuls)",
                category: "community",
                state: "MA",
                lat: 42.3376,
                lng: -71.2087,
                location: "Newton, MA",
                description: "New England's largest food rescue operation, preventing 5M+ pounds of fresh food from going to waste each year.",
                impact: "Cosmic Shift IPA beneficiary. Their trucks rescue food daily from grocery stores and restaurants. Shelter director Mike says: 'Spoonfuls brings us restaurant-quality food. Our guests eat with dignity.'",
                image: "https://images.unsplash.com/photo-1593113616828-6f22bca04804?w=400&h=200&fit=crop",
                url: "https://spoonfuls.org",
                donateUrl: "https://spoonfuls.org/donate"
            },

            // RHODE ISLAND - Cosmic Shift Beneficiary
            {
                name: "Rhode Island Community Food Bank",
                category: "community",
                state: "RI",
                lat: 41.8176,
                lng: -71.3743,
                location: "Providence, RI",
                description: "Fighting hunger and improving lives by providing nutritious food to Rhode Islanders facing food insecurity.",
                impact: "Cosmic Shift IPA beneficiary. They distributed 18 million pounds of food last year. Grandmother Rosa shares: 'When times get hard, the food bank is there. My grandkids never go to bed hungry.'",
                image: "https://images.unsplash.com/photo-1488459716781-31db52582fe9?w=400&h=200&fit=crop",
                url: "https://rifoodbank.org",
                donateUrl: "https://rifoodbank.org/donate"
            },

            // CONNECTICUT - Cosmic Shift Beneficiary
            {
                name: "Alzheimer's Association - CT Chapter",
                category: "community",
                state: "CT",
                lat: 41.3651,
                lng: -72.9275,
                location: "New Haven, CT",
                description: "Leading the way in Alzheimer's care, support, and research - providing resources for patients and their families.",
                impact: "Cosmic Shift IPA beneficiary. Their support groups help caregivers cope. David, caring for his wife, says: 'I thought I was alone until I found this community. Now I have strength to keep going.'",
                image: "https://images.unsplash.com/photo-1576765608535-5f04d1e3f289?w=400&h=200&fit=crop",
                url: "https://alz.org/ct",
                donateUrl: "https://act.alz.org/donate"
            },

            // NEW YORK - Cosmic Shift Beneficiaries
            {
                name: "City Harvest",
                category: "community",
                state: "NY",
                lat: 40.7549,
                lng: -73.9840,
                location: "New York, NY",
                description: "NYC's largest food rescue organization, collecting excess food and delivering it to soup kitchens, food pantries, and community programs.",
                impact: "Cosmic Shift IPA beneficiary. Their trucks rescue 70 million pounds of food annually. Chef Marcus volunteers weekly: 'Food that would be thrown away instead feeds thousands. That's the magic of City Harvest.'",
                image: "https://images.unsplash.com/photo-1593113630400-ea4288922497?w=400&h=200&fit=crop",
                url: "https://cityharvest.org",
                donateUrl: "https://cityharvest.org/donate"
            },
            {
                name: "United Way of Greater Rochester",
                category: "community",
                state: "NY",
                lat: 43.1566,
                lng: -77.6088,
                location: "Rochester, NY",
                description: "Building stronger communities through education, financial stability, and health initiatives across the Finger Lakes region.",
                impact: "Cosmic Shift IPA beneficiary. Their early literacy programs have helped 3,000+ kids start school ready to learn. Teacher Patricia notes: 'The difference is clear on day one. These kids are confident and curious.'",
                image: "https://images.unsplash.com/photo-1509062522246-3755977927d7?w=400&h=200&fit=crop",
                url: "https://unitedwayrocflx.org",
                donateUrl: "https://unitedwayrocflx.org/donate"
            },

            // NEW JERSEY - Cosmic Shift Beneficiary
            {
                name: "Community FoodBank of New Jersey",
                category: "community",
                state: "NJ",
                lat: 40.7101,
                lng: -74.2097,
                location: "Hillside, NJ",
                description: "Fighting hunger and poverty in New Jersey, distributing food to over 800 partner agencies across the state.",
                impact: "Cosmic Shift IPA beneficiary. They provide 90 million meals annually. Single dad Robert shares: 'The food bank doesn't just fill our fridge - it lets me be a better father because I'm not worried about dinner.'",
                image: "https://images.unsplash.com/photo-1578357078586-491adf1aa5ba?w=400&h=200&fit=crop",
                url: "https://cfbnj.org",
                donateUrl: "https://cfbnj.org/donate"
            },

            // PENNSYLVANIA - Cosmic Shift Beneficiary
            {
                name: "Philabundance",
                category: "community",
                state: "PA",
                lat: 39.9153,
                lng: -75.1566,
                location: "Philadelphia, PA",
                description: "The Delaware Valley's largest hunger relief organization, serving 135,000+ people weekly through 350 agency partners.",
                impact: "Cosmic Shift IPA beneficiary. Their Community Kitchen also trains formerly incarcerated individuals for culinary careers. Graduate Jerome says: 'They gave me skills and a second chance. Now I'm a sous chef.'",
                image: "https://images.unsplash.com/photo-1541014741259-de529411b96a?w=400&h=200&fit=crop",
                url: "https://philabundance.org",
                donateUrl: "https://philabundance.org/donate"
            },

            // VIRGINIA - Conservation Partner
            {
                name: "James River Association",
                category: "community",
                state: "VA",
                lat: 37.5328,
                lng: -77.4360,
                location: "Richmond, VA",
                description: "Protecting and restoring Virginia's historic James River watershed from the mountains to the Chesapeake Bay since 1976.",
                impact: "Their paddle trips connect thousands with the river each year. Kayaker Christine says: 'I never knew Richmond had such an amazing river until JRA showed me. Now I'm a volunteer river cleaner.'",
                image: "https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=400&h=200&fit=crop",
                url: "https://thejamesriver.org",
                donateUrl: "https://thejamesriver.org/donate"
            },

            // NORTH CAROLINA - Conservation & Food Security Partners
            {
                name: "Blue Ridge Parkway Foundation",
                category: "community",
                state: "NC",
                lat: 35.5682,
                lng: -82.5315,
                location: "Asheville, NC",
                description: "Preserving America's Favorite Drive by supporting trails, overlooks, and visitor experiences along 469 miles of scenic mountain road.",
                impact: "Their trail crews maintain hundreds of miles of hiking paths. Volunteer Sam shares: 'Every weekend, we're out there clearing trails so families can enjoy these views for generations to come.'",
                image: "https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?w=400&h=200&fit=crop",
                url: "https://brpfoundation.org",
                donateUrl: "https://brpfoundation.org/donate"
            },
            {
                name: "French Broad Riverkeeper (MountainTrue)",
                category: "community",
                state: "NC",
                lat: 35.5946,
                lng: -82.5516,
                location: "Asheville, NC",
                description: "Protecting the waters of the French Broad River watershed through monitoring, advocacy, and community engagement.",
                impact: "Their water quality testing and advocacy has made the French Broad swimmable again. Paddler Jen says: 'I remember when no one would touch this water. Now my kids swim here every summer.'",
                image: "https://images.unsplash.com/photo-1468413253725-0d5181091126?w=400&h=200&fit=crop",
                url: "https://mountaintrue.org",
                donateUrl: "https://mountaintrue.org/donate"
            },
            {
                name: "MANNA FoodBank",
                category: "community",
                state: "NC",
                lat: 35.5781,
                lng: -82.5024,
                location: "Asheville, NC",
                description: "Ending hunger in Western North Carolina by distributing 50,000+ pounds of food daily through 200+ partner organizations.",
                impact: "After Hurricane Helene, MANNA mobilized emergency food distribution to hard-hit communities. Recipient Angela says: 'We lost everything, but MANNA made sure we didn't lose hope. Hot meals meant the world.'",
                image: "https://images.unsplash.com/photo-1594708767771-a7502f8a2e7c?w=400&h=200&fit=crop",
                url: "https://mannafoodbank.org",
                donateUrl: "https://mannafoodbank.org/donate"
            },

            // === DC FAST CHARGERS ===
            // North Carolina
            {
                name: "Tesla Supercharger - Asheville",
                category: "charger",
                lat: 35.5732,
                lng: -82.5413,
                location: "264 Thetford St, Asheville, NC",
                description: "Tesla Supercharger with 8 stalls, up to 250kW. Located near downtown Asheville.",
                url: "https://www.tesla.com/findus"
            },
            {
                name: "Tesla Supercharger - Mt Airy",
                category: "charger",
                lat: 36.5082,
                lng: -80.6193,
                location: "2905 Rockford St, Mt Airy, NC",
                description: "Tesla Supercharger with 8 stalls, up to 250kW. Great stop on Blue Ridge Parkway northern section.",
                url: "https://www.tesla.com/findus"
            },
            {
                name: "Electrify America - Boone",
                category: "charger",
                lat: 36.2038,
                lng: -81.6580,
                location: "1180 Blowing Rock Rd, Boone, NC",
                description: "Electrify America DC fast chargers at Walmart, up to 350kW. Near Blowing Rock and Blue Ridge Parkway.",
                url: "https://www.electrifyamerica.com/locate-charger/"
            },
            // Virginia
            {
                name: "Electrify America - Staunton",
                category: "charger",
                lat: 38.1408,
                lng: -79.0556,
                location: "255 Lucy Ln, Staunton, VA",
                description: "Electrify America DC fast chargers at Walmart, up to 350kW. Perfect stop at the north end of Skyline Drive.",
                url: "https://www.electrifyamerica.com/locate-charger/"
            },
            {
                name: "Tesla Supercharger - Waynesboro",
                category: "charger",
                lat: 38.0686,
                lng: -78.9036,
                location: "109 Lucy Ln, Waynesboro, VA",
                description: "Tesla Supercharger with 12 stalls, up to 250kW. Near Skyline Drive and Blue Ridge Parkway junction.",
                url: "https://www.tesla.com/findus"
            },
            {
                name: "Tesla Supercharger - Charlottesville",
                category: "charger",
                lat: 38.0543,
                lng: -78.4975,
                location: "1954 Rio Hill Center, Charlottesville, VA",
                description: "Tesla Supercharger with 12 stalls, up to 250kW. Great stop when heading north from Skyline Drive.",
                url: "https://www.tesla.com/findus"
            },
            // Massachusetts
            {
                name: "Electrify America - Springfield",
                category: "charger",
                lat: 42.1186,
                lng: -72.5428,
                location: "1655 Boston Rd, Springfield, MA",
                description: "Electrify America DC fast chargers at Walmart, up to 350kW. Gateway to New England.",
                url: "https://www.electrifyamerica.com/locate-charger/"
            },
            // New Hampshire
            {
                name: "Electrify America - Hooksett",
                category: "charger",
                lat: 43.0697,
                lng: -71.4378,
                location: "1328 Hooksett Rd, Hooksett, NH",
                description: "Electrify America DC fast chargers, up to 350kW. Key I-93 corridor stop en route to Vermont.",
                url: "https://www.electrifyamerica.com/locate-charger/"
            },
            // Vermont
            {
                name: "ChargePoint DC Fast - Waitsfield",
                category: "charger",
                lat: 44.1861,
                lng: -72.8277,
                location: "5134 Main St, Waitsfield, VT",
                description: "ChargePoint DC fast charger at Mobil station, 180kW. Right in the heart of Mad River Valley near Lawson's Taproom.",
                url: "https://www.chargepoint.com/en-us/drivers/find-charger"
            },
            {
                name: "ChargePoint DC Fast - Mad River Green",
                category: "charger",
                lat: 44.1875,
                lng: -72.8261,
                location: "Village Square, Waitsfield, VT",
                description: "ChargePoint DC fast charger at Mad River Green shopping center, 62kW. Walking distance to local shops and Lawson's.",
                url: "https://www.chargepoint.com/en-us/drivers/find-charger"
            },
            {
                name: "Tesla Supercharger - Waterbury",
                category: "charger",
                lat: 44.3396,
                lng: -72.7530,
                location: "1899 Waterbury-Stowe Rd, Waterbury, VT",
                description: "Tesla Supercharger with 8 stalls near Ben & Jerry's Factory. Popular tourist stop.",
                url: "https://www.tesla.com/findus"
            },
            {
                name: "Electrify America - White River Junction",
                category: "charger",
                lat: 43.6489,
                lng: -72.3195,
                location: "270 N Hartland Rd, White River Junction, VT",
                description: "Electrify America DC fast chargers at Walmart, up to 350kW. Key I-91/I-89 interchange stop.",
                url: "https://www.electrifyamerica.com/locate-charger/"
            },
            {
                name: "NEVI Fast Charger - Bradford",
                category: "charger",
                lat: 43.9931,
                lng: -72.1292,
                location: "172 Waits River Rd, Bradford, VT",
                description: "Vermont NEVI program DC fast charger at Denny Park, up to 150kW. Scenic I-91 corridor charging.",
                url: "https://www.driveelectricvt.com/"
            }
        ];

        // Create layer groups for each category
        const layers = {
            retailer: L.layerGroup(),
            trail: L.layerGroup(),
            river: L.layerGroup(),
            community: L.layerGroup(),
            charger: L.layerGroup()
        };

        // Add markers to respective layers
        sunshineSpots.forEach(spot => {
            const icon = createMarkerIcon(spot.category);

            // Build popup content with enhanced information for community partners
            let popupContent = '';

            // Add image if available
            if (spot.image) {
                popupContent += `<img src="${spot.image}" alt="${spot.name}" class="popup-image" loading="lazy">`;
            }

            const categoryLabel = spot.category === 'community' ? 'Community Partner' :
                                   spot.category === 'charger' ? 'DC Fast Charger' : spot.category;
            popupContent += `
                <div class="popup-category ${spot.category}">${categoryLabel}</div>
                <div class="popup-title">${spot.name}</div>
                <div class="popup-description">${spot.description}</div>
                <div class="popup-location">${spot.location}</div>
            `;

            // Add impact story for community partners
            if (spot.impact) {
                popupContent += `
                    <div class="popup-impact">
                        <div class="popup-impact-label">Impact Story</div>
                        ${spot.impact}
                    </div>
                `;
            }

            // Add buttons
            if (spot.url || spot.donateUrl) {
                popupContent += '<div class="popup-buttons">';
                if (spot.url) {
                    popupContent += `<a href="${spot.url}" target="_blank" rel="noopener noreferrer" class="popup-btn popup-btn-primary">Learn More</a>`;
                }
                if (spot.donateUrl) {
                    popupContent += `<a href="${spot.donateUrl}" target="_blank" rel="noopener noreferrer" class="popup-btn popup-btn-secondary">Donate</a>`;
                }
                popupContent += '</div>';
            }

            const marker = L.marker([spot.lat, spot.lng], { icon: icon })
                .bindPopup(popupContent, { maxWidth: 320 });

            layers[spot.category].addLayer(marker);
        });

        // Add all layers to map
        Object.values(layers).forEach(layer => layer.addTo(map));

        // Update counts
        function updateCounts() {
            document.getElementById('count-retailers').textContent = sunshineSpots.filter(s => s.category === 'retailer').length;
            document.getElementById('count-trails').textContent = sunshineSpots.filter(s => s.category === 'trail').length;
            document.getElementById('count-rivers').textContent = sunshineSpots.filter(s => s.category === 'river').length;
            document.getElementById('count-community').textContent = sunshineSpots.filter(s => s.category === 'community').length;
            document.getElementById('count-chargers').textContent = sunshineSpots.filter(s => s.category === 'charger').length;
        }
        updateCounts();

        // Filter functionality
        document.getElementById('filter-retailers').addEventListener('change', function() {
            if (this.checked) {
                map.addLayer(layers.retailer);
            } else {
                map.removeLayer(layers.retailer);
            }
        });

        document.getElementById('filter-trails').addEventListener('change', function() {
            if (this.checked) {
                map.addLayer(layers.trail);
            } else {
                map.removeLayer(layers.trail);
            }
        });

        document.getElementById('filter-rivers').addEventListener('change', function() {
            if (this.checked) {
                map.addLayer(layers.river);
            } else {
                map.removeLayer(layers.river);
            }
        });

        document.getElementById('filter-community').addEventListener('change', function() {
            if (this.checked) {
                map.addLayer(layers.community);
            } else {
                map.removeLayer(layers.community);
            }
        });

        document.getElementById('filter-chargers').addEventListener('change', function() {
            if (this.checked) {
                map.addLayer(layers.charger);
            } else {
                map.removeLayer(layers.charger);
            }
        });

        // Fit map to show all markers with smooth animation
        const allMarkers = sunshineSpots.map(s => [s.lat, s.lng]);
        map.fitBounds(allMarkers, {
            padding: [50, 50],
            animate: true,
            duration: 1.0
        });

        // State filtering for community partners
        let currentStateFilter = 'all';
        const stateButtons = document.querySelectorAll('.state-btn');

        // Store original community markers for filtering
        const communityMarkers = [];
        sunshineSpots.filter(s => s.category === 'community').forEach(spot => {
            const icon = createMarkerIcon('community');
            let popupContent = '';
            if (spot.image) {
                popupContent += `<img src="${spot.image}" alt="${spot.name}" class="popup-image" loading="lazy">`;
            }
            popupContent += `
                <div class="popup-category community">Community Partner</div>
                <div class="popup-title">${spot.name}</div>
                <div class="popup-description">${spot.description}</div>
                <div class="popup-location">${spot.location}</div>
            `;
            if (spot.impact) {
                popupContent += `
                    <div class="popup-impact">
                        <div class="popup-impact-label">Impact Story</div>
                        ${spot.impact}
                    </div>
                `;
            }
            if (spot.url || spot.donateUrl) {
                popupContent += '<div class="popup-buttons">';
                if (spot.url) {
                    popupContent += `<a href="${spot.url}" target="_blank" rel="noopener noreferrer" class="popup-btn popup-btn-primary">Learn More</a>`;
                }
                if (spot.donateUrl) {
                    popupContent += `<a href="${spot.donateUrl}" target="_blank" rel="noopener noreferrer" class="popup-btn popup-btn-secondary">Donate</a>`;
                }
                popupContent += '</div>';
            }

            const marker = L.marker([spot.lat, spot.lng], { icon: icon })
                .bindPopup(popupContent, { maxWidth: 320 });

            communityMarkers.push({ marker, state: spot.state, spot });
        });

        function filterByState(state) {
            currentStateFilter = state;

            // Update button states
            stateButtons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.state === state) {
                    btn.classList.add('active');
                }
            });

            // Clear community layer and rebuild with filtered markers
            layers.community.clearLayers();

            communityMarkers.forEach(({ marker, state: markerState }) => {
                if (state === 'all' || markerState === state) {
                    layers.community.addLayer(marker);
                }
            });

            // Update community count badge
            const filteredCount = state === 'all'
                ? communityMarkers.length
                : communityMarkers.filter(m => m.state === state).length;
            document.getElementById('count-community').textContent = filteredCount;

            // If filtering to a specific state, zoom to show those markers
            if (state !== 'all') {
                const filteredSpots = communityMarkers.filter(m => m.state === state);
                if (filteredSpots.length > 0) {
                    const bounds = filteredSpots.map(m => [m.spot.lat, m.spot.lng]);
                    map.fitBounds(bounds, {
                        padding: [80, 80],
                        animate: true,
                        duration: 0.5,
                        maxZoom: 10
                    });
                }
            }
        }

        // Add click handlers to state buttons
        stateButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                filterByState(btn.dataset.state);
            });
        });

        // Animated counter for metrics
        function animateCounter(element, target, duration = 2000, isDecimal = false) {
            const start = 0;
            const startTime = performance.now();
            const parent = element.parentElement;

            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);

                // Easing function for smooth animation
                const easeOutQuart = 1 - Math.pow(1 - progress, 4);
                const current = start + (target - start) * easeOutQuart;

                if (isDecimal) {
                    element.textContent = current.toFixed(1);
                } else {
                    element.textContent = Math.floor(current).toLocaleString();
                }

                if (progress < 1) {
                    requestAnimationFrame(update);
                }
            }

            requestAnimationFrame(update);
        }

        // Start counter animation when metrics section comes into view
        function startMetricsAnimation() {
            const metricNumbers = document.querySelectorAll('.metric-number');

            metricNumbers.forEach(el => {
                const target = parseFloat(el.dataset.target);
                const isDecimal = el.dataset.decimal === 'true';
                animateCounter(el, target, 2500, isDecimal);
            });
        }

        // Use Intersection Observer to trigger animation when visible
        const metricsSection = document.querySelector('.metrics-section');
        if (metricsSection) {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        startMetricsAnimation();
                        observer.unobserve(entry.target);
                    }
                });
            }, { threshold: 0.5 });

            observer.observe(metricsSection);
        }

        // ============================================
        // SCENIC ROUTE OVERLAYS
        // The Sunshine Trail: Asheville, NC to Waitsfield, VT
        // ============================================

        // Define scenic route coordinates
        // Blue Ridge Parkway: Asheville, NC (Milepost 382) to Waynesboro, VA (Milepost 0)
        const blueRidgeParkway = [
            [35.5951, -82.5515],  // Asheville, NC
            [35.6810, -82.4920],  // Craggy Gardens
            [35.7972, -82.9569],  // Max Patch area
            [35.9150, -82.2760],  // Mount Mitchell area
            [36.1064, -82.1098],  // Roan Mountain
            [36.2987, -81.6904],  // Blowing Rock
            [36.3396, -81.4996],  // Boone area
            [36.5569, -80.9897],  // Fancy Gap
            [36.7180, -80.4070],  // Mabry Mill
            [37.0889, -80.1869],  // Roanoke area
            [37.2390, -80.0328],  // McAfee Knob area
            [37.4530, -79.6190],  // Natural Bridge
            [37.6600, -79.3400],  // Lexington area
            [37.8600, -79.0800],  // Staunton area
            [38.0330, -78.8690],  // Waynesboro (BRP northern terminus)
        ];

        // Skyline Drive: Waynesboro (Rockfish Gap) to Front Royal
        const skylineDrive = [
            [38.0330, -78.8690],  // Rockfish Gap (southern entrance)
            [38.1900, -78.7500],  // Swift Run Gap
            [38.3000, -78.6800],  // Big Meadows
            [38.4500, -78.5500],  // Skyland
            [38.5533, -78.3161],  // Old Rag nearby
            [38.6300, -78.3800],  // Thornton Gap
            [38.7500, -78.2800],  // Dickey Ridge
            [38.9030, -78.1940],  // Front Royal (northern terminus)
        ];

        // Connector Route: Front Royal, VA to Bennington, VT via I-81 / I-87 / US-7
        const connectorRoute = [
            [38.9030, -78.1940],  // Front Royal, VA
            [39.1850, -77.5100],  // Winchester, VA
            [39.4580, -77.4000],  // Hagerstown, MD
            [39.7600, -77.5700],  // Chambersburg, PA
            [40.2700, -76.8800],  // Harrisburg, PA
            [40.5800, -75.4900],  // Allentown area
            [41.0400, -74.1300],  // Northern NJ
            [41.7000, -73.9200],  // Poughkeepsie, NY
            [42.2500, -73.7900],  // Hudson, NY
            [42.6500, -73.7500],  // Albany area
            [42.8800, -73.2000],  // Bennington, VT
        ];

        // Vermont Route 100: Wilmington to Waitsfield
        const route100Vermont = [
            [42.8800, -73.2000],  // Bennington (connector)
            [42.8678, -72.8711],  // Wilmington
            [43.1597, -72.7792],  // Jamaica
            [43.2600, -72.7400],  // Londonderry
            [43.3890, -72.7000],  // Weston
            [43.4700, -72.7300],  // Ludlow
            [43.5500, -72.7100],  // Plymouth
            [43.6200, -72.8000],  // Killington
            [43.7100, -72.8200],  // Pittsfield
            [43.8800, -72.8400],  // Rochester / Hancock
            [43.9700, -72.8400],  // Granville (Moss Glen Falls)
            [44.0800, -72.8200],  // Warren
            [44.1852, -72.8288],  // Waitsfield (Lawson's HQ!)
            [44.3856, -72.7469],  // Waterbury (Cold Hollow)
            [44.4654, -72.6874],  // Stowe
        ];

        // Create route layers
        const routeLayers = L.layerGroup();

        const blueRidgePolyline = L.polyline(blueRidgeParkway, {
            color: '#2E86AB',
            weight: 5,
            opacity: 0.85,
            smoothFactor: 1.5,
            dashArray: null
        }).bindPopup('<strong>Blue Ridge Parkway</strong><br>469 miles of America\'s most scenic mountain road, connecting Great Smoky Mountains to Shenandoah National Park.');

        const skylinePolyline = L.polyline(skylineDrive, {
            color: '#7B68EE',
            weight: 5,
            opacity: 0.85,
            smoothFactor: 1.5,
            dashArray: null
        }).bindPopup('<strong>Skyline Drive</strong><br>105 miles through Shenandoah National Park with 75 scenic overlooks and stunning Blue Ridge views.');

        const connectorPolyline = L.polyline(connectorRoute, {
            color: '#888888',
            weight: 3,
            opacity: 0.6,
            smoothFactor: 1.5,
            dashArray: '10, 10'
        }).bindPopup('<strong>Connector Route</strong><br>Interstate and highway connection from Shenandoah to southern Vermont via the Hudson Valley.');

        const route100Polyline = L.polyline(route100Vermont, {
            color: '#228B22',
            weight: 5,
            opacity: 0.85,
            smoothFactor: 1.5,
            dashArray: null
        }).bindPopup('<strong>Vermont Route 100</strong><br>217 miles through the Green Mountains - Vermont\'s "Main Street" and the best fall foliage drive in New England.');

        // Add all routes to the layer group
        routeLayers.addLayer(blueRidgePolyline);
        routeLayers.addLayer(skylinePolyline);
        routeLayers.addLayer(connectorPolyline);
        routeLayers.addLayer(route100Polyline);

        // Toggle scenic route visibility
        const routeToggle = document.getElementById('toggle-scenic-route');
        const routeLegend = document.getElementById('route-legend');

        routeToggle.addEventListener('change', function() {
            if (this.checked) {
                map.addLayer(routeLayers);
                routeLegend.style.display = 'flex';

                // Animate to show full route
                const fullRoute = [
                    ...blueRidgeParkway,
                    ...skylineDrive,
                    ...connectorRoute,
                    ...route100Vermont
                ];
                map.fitBounds(fullRoute, {
                    padding: [50, 50],
                    animate: true,
                    duration: 1.0
                });
            } else {
                map.removeLayer(routeLayers);
                routeLegend.style.display = 'none';
            }
        });
    </script>
</body>
</html>
